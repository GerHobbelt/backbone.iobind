/*!
 * backbone.iobind
 * Copyright(c) 2011 Jake Luer <@jakeluer>
 * MIT Licensed
 * https://logicalparadox.github.com/backbone.iobind
 */Backbone.Model.prototype.ioBindVersion="0.1.2",Backbone.Collection.prototype.ioBindVersion="0.1.2",Backbone.Model.prototype.ioBind=function(eventName,io,callback,context){var ioEvents=this._ioEvents||(this._ioEvents={}),globalName=this.url()+":"+eventName,self=this,event={name:eventName,global:globalName,cbLocal:callback,cbGlobal:function(data){self.trigger(eventName,data)}};return this.bind(event.name,event.cbLocal,context||self),io.on(event.global,event.cbGlobal),ioEvents[event.name]?ioEvents[event.name].push(event):ioEvents[event.name]=[event],this},Backbone.Model.prototype.ioUnbind=function(eventName,io,callback){var ioEvents=this._ioEvents||(this._ioEvents={}),globalName=this.url()+":"+eventName,self=this,events=ioEvents[eventName];if(!_.isEmpty(events)){if(callback&&"function"==typeof callback){for(var i=0,l=events.length;i<l;i++)callback==events[i].cbLocal&&(this.unbind(events[i].name,events[i].cbLocal),io.removeListener(events[i].global,events[i].cbGlobal),events[i]=!1);events=_.compact(events)}else this.unbind(eventName),io.removeAllListeners(globalName);events.length===0&&delete ioEvents[eventName]}return this},Backbone.Model.prototype.ioUnbindAll=function(io){var ioEvents=this._ioEvents||(this._ioEvents={});for(var ev in ioEvents)this.ioUnbind(ev,io);return this},Backbone.Collection.prototype.ioBind=function(eventName,io,callback,context){var ioEvents=this._ioEvents||(this._ioEvents={}),globalName=this.url+":"+eventName,self=this,event={name:eventName,global:globalName,cbLocal:callback,cbGlobal:function(data){self.trigger(eventName,data)}};return this.bind(event.name,event.cbLocal,context),io.on(event.global,event.cbGlobal),ioEvents[event.name]?ioEvents[event.name].push(event):ioEvents[event.name]=[event],this},Backbone.Collection.prototype.ioUnbind=function(eventName,io,callback){var ioEvents=this._ioEvents||(this._ioEvents={}),globalName=this.url+":"+eventName,self=this,events=ioEvents[eventName];if(!_.isEmpty(events)){if(callback&&"function"==typeof callback){for(var i=0,l=events.length;i<l;i++)callback==events[i].cbLocal&&(this.unbind(events[i].name,events[i].cbLocal),io.removeListener(events[i].global,events[i].cbGlobal),events[i]=!1);events=_.compact(events)}else this.unbind(eventName),io.removeAllListeners(globalName);events.length===0&&delete ioEvents[eventName]}return this},Backbone.Collection.prototype.ioUnbindAll=function(io){var ioEvents=this._ioEvents||(this._ioEvents={});for(var ev in ioEvents)this.ioUnbind(ev,io);return this}